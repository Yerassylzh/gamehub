{% load static %}

<div class="image-container">
  <img src="{{ main_image_url }}" id="image" class="img-fluid image">
  <button data-left-button class="left-button">
    <img data-left-img src="{% static 'img/left_arrow_for_image.png' %}" alt="<-" class="arrow-img">
  </button>
  <button class="right-button">
    <img data-right-img src="{% static 'img/right_arrow_for_image.png' %}" alt="->" class="arrow-img">
  </button>
</div>

<script>
  let CLUB_DETAILS = "{% url 'club:club_details' pk %}"

  document.addEventListener("click", e => {
    if (!e.target.matches("[data-left-img]") && e.target.closest("[data-left-img]") == null) return

    $.ajax({
      method: "POST",
      url: CLUB_DETAILS,
      data: {
          "action": "get-left-image",
          "current_image_url": document.getElementById("image").getAttribute("src"),
          "csrfmiddlewaretoken": CSRF_TOKEN,
      },
      dataType: "json",
      success: function(data) {
        document.getElementById("image").setAttribute("src", data["current_image_url"])
      },
      error: function(xhr, errmsg, err) {
          console.log(xhr.status + ":" + xhr.responseText)
      }
    })
  })

  document.addEventListener("click", e => {
    if (!e.target.matches("[data-right-img]") && e.target.closest("[data-right-img]") == null) return

    $.ajax({
      method: "POST",
      url: CLUB_DETAILS,
      data: {
          "action": "get-right-image",
          "current_image_url": document.getElementById("image").getAttribute("src"),
          "csrfmiddlewaretoken": CSRF_TOKEN,
      },
      dataType: "json",
      success: function(data) {
        document.getElementById("image").setAttribute("src", data["current_image_url"])
      },
      error: function(xhr, errmsg, err) {
          console.log(xhr.status + ":" + xhr.responseText)
      }
    })
  })

</script>

<style>
  .image {
    border-radius: 10px;
    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.5);
  }

  .image-container {
    width: 100%;
    aspect-ratio: 4 / 3;
    overflow: hidden;

    position: relative;
  }

  .right-button {
    position: absolute;
    right: 1rem;
    top: calc(50% - 15px);

    background-color: #27403C;

    border: none;
    outline: none;
    border-radius: 50%;
    padding: 5px;

    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .right-button:hover {
    background-color: #40595A;
  }

  .left-button {
    position: absolute;
    left: 1rem;
    top: calc(50% - 15px);

    background-color: #27403C;

    border: none;
    outline: none;
    border-radius: 50%;
    padding: 5px;

    display: flex;
    align-items: center;
    justify-content: center;
  }

  .left-button:hover {
    background-color: #40595A;
  }

  .arrow-img {
    width: 20px;
    height: 20px;
  }
</style>